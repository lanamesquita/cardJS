<!--
   Requisitos:
   - Criar um forms no GoogleForms para cadastrar as dicas de ética. Nesse cadastro tem um campo texto longo. OK
   - Investigar a quantidade de caracteres máximo do texto. -> 120
   - Criar um carrosel em html e javascript
   - Os textos devem ser atualizados a cada 2 minutos de forma randômica. Alterar a cor de fundo. Utilizar paleta com vários tons de azul.
   - Inserir carrosel na Intranet.
   -->
<meta charset="UTF-8">

<!-- CSS -->
<style type="text/css">
    body {
        width: 100%;
        height: 100%;
        margin: 0;
    }

    #blocoMensagem {
        width: 228px;
        height: 170px;
        padding: 5px;
        position: relative;
        background: #ededed;
        display: flex;
        align-items: center;
        /* Vertical center alignment */
        justify-content: center;
        /* Horizontal center alignment */
        cursor: pointer;
    }

    #texto {
        display: inline-block;
        position: absolute;
        text-align: center;
        padding-left: 30px;
        padding-right: 30px;
        font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        font-weight: 200;
    }

    #imagem {
        width: 100%;
        height: 100%;
        opacity: 70%;
        position: absolute;
        top: 0;
        left: 0;
    }

    /* lista de cores para usar no fundo: #0a2161", #5c81e6", #164ce0, #192c61, #113aad */
</style>
<div>
    <div id="blocoMensagem" onclick="readCSVFile(target);">
        <img id="imagem" src="imagem.svg">
        <p id="texto">...</p>
    </div>

</div>
<script>
    const target = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQSHuOn8ktKO3l4rirMV_TjqSP7mOizvssdFFb6VMLcl4kIxNB44h6kJNmHEPM73qdCNT4huOKSM1oi/pub?gid=1648505482&single=true&output=tsv";


    const readCSVFile = async () => {

        try {
            const response = await fetch(target, {
                method: 'get',
                headers: {
                    'content-type': 'text/csv;charset=UTF-8',
                }
            })

            if (response.status === 200) {
                const data = await response.text();
                //console.log(data);
                getRandomMessage(data);
            } else {
                console.log(`Error code ${response.status}`);
            }
        } catch (err) {
            console.log(err)
        }

    }

    function randomIntFromInterval(min, max) { // min and max included 
        return Math.floor(Math.random() * (max - min + 1) + min)
    }

    function getRandomMessage(csvdata) {
        var rowData = csvdata.split('\n');
        var randomLine = randomIntFromInterval(2,rowData.length-1);
        console.log("Linha escolhida: " + randomLine);

        let texto = rowData[randomLine].split('\t')[2];
        console.log("Texto: " + texto);
        var messageElement = document.getElementById('texto');
        messageElement.innerHTML = texto;
    }

    document.addEventListener("DOMContentLoaded", function () {
        readCSVFile();
    });


</script>